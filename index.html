<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Drone LogBook v1.1.3</title>
  <link rel="manifest" href="manifest.json" />
  <style>
    body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Arial,sans-serif;background:#0f1216;color:#e7e7e7;margin:0}
    .wrap{max-width:1100px;margin:24px auto;padding:0 16px}
    h1{font-size:28px;margin:0 0 16px}
    .card{background:#151a20;border:1px solid #202833;border-radius:12px;padding:16px;margin:16px 0}
    label{display:block;margin:10px 0 6px;font-weight:600}
    input,select,textarea{width:100%;padding:10px;border-radius:8px;border:1px solid #2a3340;background:#0f141a;color:#e7e7e7}
    textarea{min-height:120px}
    .row{display:grid;grid-template-columns:1fr 1fr;gap:16px}
    .row3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px}
    .btn{background:#1185ff;border:0;color:#fff;padding:10px 14px;border-radius:10px;cursor:pointer;font-weight:700}
    .btn.secondary{background:#2c3750}
    .btn.warn{background:#ff9c07;color:#111}
    .btn.danger{background:#e04d44}
    .btn:disabled{opacity:.5;cursor:not-allowed}
    .stack{display:flex;gap:12px;flex-wrap:wrap}
    .right{justify-content:flex-end}
    #toast{position:fixed;left:50%;transform:translateX(-50%);bottom:-60px;background:#1e293b;border:1px solid #334155;border-radius:10px;padding:10px 14px;transition:all .25s;z-index:999}
    #toast.show{bottom:18px}
    #toast.ok{border-color:#0ea5e9}
    #toast.warn{border-color:#f59e0b}
    #toast.err{border-color:#ef4444}
    #log-console{height:220px;overflow:auto;white-space:pre;background:#0c0f13;border:1px solid #1f2a38;border-radius:10px;padding:10px}
    small.muted{opacity:.7}
  </style>
</head>
<body>
  <div class="wrap">
    <h1>Drone LogBook <span style="opacity:.6">v1.1.3</span></h1>

    <!-- Sign-in -->
    <div class="card">
      <div class="stack">
        <button id="btn-google" type="button" class="btn" onclick="window.fakeGoogleSignIn()">Sign in with Google</button>
        <button id="btn-microsoft" type="button" class="btn secondary" onclick="window.fakeMicrosoftSignIn()">Sign in with Microsoft</button>
        <span id="signed-in-as" data-email="" style="align-self:center"></span>
      </div>
    </div>

    <!-- Settings -->
    <div class="card">
      <h3>Settings</h3>
      <div class="row">
        <div>
          <label for="provider">Provider</label>
          <select id="provider">
            <option value="google" selected>Google</option>
            <option value="microsoft">Microsoft (coming soon)</option>
          </select>
        </div>
        <div>
          <label for="target-sheet-id">Target Sheet or Folder URL (Shared OK)</label>
          <input id="target-sheet-id" placeholder="Paste a Google Sheet link (recommended). If blank, a Flight Log sheet is created in your Drive." />
        </div>
      </div>
      <div class="stack right" style="margin-top:12px">
        <button id="btn-validate-link" class="btn secondary">Validate Link</button>
        <button id="btn-save-settings" class="btn">Save settings</button>
        <span id="validate-status" class="pill small"></span>
        <span>Queue: <strong id="queue-count">0</strong></span>
      </div>
      <div style="margin-top:8px">
        <small class="muted">
          <b>Shared:</b> paste a Google Sheet link that lives in your Shared Drive.<br />
          <b>Personal:</b> leave blank to save to your own My Drive (auto creates a “Flight Log” sheet).<br />
          <b>Wind note:</b> Wind auto-fills only when online and GPS coordinates are present.
        </small>
      </div>
    </div>

    <!-- Flight Log -->
    <div class="card">
      <h3>Flight Log</h3>

      <div class="row">
        <div>
          <label for="flight-name">Flight Name</label>
          <input id="flight-name" placeholder="Harbour Mapping Run 1" />
        </div>
        <div>
          <label for="project">Project / Job</label>
          <input id="project" placeholder="Sooke Harbour Eelgrass Survey" />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="pilot-name">Pilot Name</label>
          <input id="pilot-name" placeholder="Your name" />
        </div>
        <div>
          <label for="observer">Observer / Ground Crew</label>
          <input id="observer" placeholder="Optional" />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="drone-model">Drone Model</label>
          <input id="drone-model" placeholder="Matrice 350 RTK" />
        </div>
        <div>
          <label for="aircraft-id">Aircraft ID / S/N</label>
          <input id="aircraft-id" placeholder="ABC12345" />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="payload">Payload</label>
          <input id="payload" placeholder="Zenmuse P1 / H30T" />
        </div>
        <div>
          <label for="mission-type">Mission Type</label>
          <input id="mission-type" placeholder="Mapping / Inspection / Training" />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="rtk-mode">RTK Mode</label>
          <input id="rtk-mode" placeholder="Fixed / Float / None" />
        </div>
        <div>
          <label for="airspace-method">Airspace Method</label>
          <input id="airspace-method" placeholder="NAV Drone / NOTAM / ATC call" />
        </div>
      </div>

      <div class="row3">
        <div>
          <label for="start-wind">Start Wind (m/s)</label>
          <input id="start-wind" placeholder="e.g., 3.2" />
        </div>
        <div>
          <label for="start-wind-dir">Start Wind Dir (°)</label>
          <input id="start-wind-dir" placeholder="0–359" />
        </div>
        <div>
          <label>&nbsp;</label>
          <div class="stack">
            <button id="btn-now-start" class="btn">Now → Start</button>
            <button id="btn-now-end" class="btn">Now → End</button>
            <button id="btn-gps" class="btn secondary">Use GPS</button>
          </div>
          <small class="muted">Auto-fills need online connection + GPS coordinates.</small>
        </div>
      </div>

      <div class="row">
        <div>
          <label for="start-local">Start Time (local)</label>
          <input id="start-local" type="datetime-local" />
        </div>
        <div>
          <label for="end-local">End Time (local)</label>
          <input id="end-local" type="datetime-local" />
        </div>
      </div>

      <div class="row">
        <div>
          <label for="takeoff-lat">Takeoff Lat</label>
          <input id="takeoff-lat" placeholder="48.371299" />
        </div>
        <div>
          <label for="takeoff-lon">Takeoff Lon</label>
          <input id="takeoff-lon" placeholder="-123.742839" />
        </div>
      </div>

      <div>
        <label for="notes">Notes</label>
        <textarea id="notes" placeholder="Optional notes"></textarea>
      </div>

      <div class="stack" style="margin-top:12px">
        <button id="btn-queue-start" class="btn">Queue Start</button>
        <button id="btn-queue-end" class="btn">Queue End</button>
        <button id="btn-sync" class="btn">Sync Now</button>
        <button id="btn-clear-queue" class="btn danger">Clear Queue (local)</button>
      </div>
    </div>

    <!-- Console -->
    <div class="card">
      <h3>Console</h3>
      <div id="log-console">[Ready] Drone LogBook v1.1.3 UI loaded.</div>
    </div>

    <!-- Support -->
    <div class="card" style="text-align:center">
      <div style="font-weight:700">For support please contact</div>
      <div style="font-size:18px;margin-top:6px;color:#ffffff">marineliaison4@tsoukenation.com</div>
    </div>
  </div>

  <div id="toast"></div>

  <!-- Make sure app.js loads after DOM -->
  <script src="app.js" defer></script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('service-worker.js').catch(()=>{});
    }
  </script>
</body>
</html>
